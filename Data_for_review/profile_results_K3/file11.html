<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:///D:\matlab\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Profile Summary</title></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><title>Function details for pdcoO&gt;pdcoO.solve</title><link rel="stylesheet" href="file:///D:\matlab\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">pdcoO&gt;pdcoO.solve (Calls: 3, Time: 3.192 s)</span><br/><i>Generated 27-Nov-2020 08:53:13 using performance time.</i><br/>class method in file D:\git_repository\Stage-K2.5\pdcoO.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Name</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Type</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file10.html">Untitled2</a></td><td class="td-linebottomrt">script</td><td class="td-linebottomrt">3</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Line Number</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Code</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Total Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">% Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line864">864</a></td><td class="td-linebottomrt"><pre>Solve_Newton(o);</pre></td><td class="td-linebottomrt">63</td><td class="td-linebottomrt">2.005 s</td><td class="td-linebottomrt" class="td-linebottomrt">62.8%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=63 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line947">947</a></td><td class="td-linebottomrt"><pre>feasibility_resids(o);</pre></td><td class="td-linebottomrt">63</td><td class="td-linebottomrt">0.220 s</td><td class="td-linebottomrt" class="td-linebottomrt">6.9%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line932">932</a></td><td class="td-linebottomrt"><pre>[o.obj, o.grad, o.hess] = o.sl...</pre></td><td class="td-linebottomrt">63</td><td class="td-linebottomrt">0.167 s</td><td class="td-linebottomrt" class="td-linebottomrt">5.2%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line730">730</a></td><td class="td-linebottomrt"><pre>o.bl(o.low) = o.bl(o.low) / o....</pre></td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.078 s</td><td class="td-linebottomrt" class="td-linebottomrt">2.4%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1103">1103</a></td><td class="td-linebottomrt"><pre>o.bu(o.upp) = o.bu(o.upp) * o....</pre></td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.060 s</td><td class="td-linebottomrt" class="td-linebottomrt">1.9%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.663 s</td><td class="td-linebottomrt">20.8%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=21 height=10></td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Totals</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">3.192 s</td><td class="td-linebottomrt" style="background-color:#F0F0F0">100%</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file31.html">K3&gt;K3.Solve_Newton</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">63</td><td class="td-linebottomrt">2.003 s</td><td class="td-linebottomrt">62.8%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=63 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file23.html">pdcoO&gt;pdcoO.feasibility_resids</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">66</td><td class="td-linebottomrt">0.239 s</td><td class="td-linebottomrt">7.5%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file16.html">nlpmodel&gt;nlpmodel.obj</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">69</td><td class="td-linebottomrt">0.196 s</td><td class="td-linebottomrt">6.1%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file24.html">pdcoO&gt;pdcoO.complementarity_resids</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">126</td><td class="td-linebottomrt">0.089 s</td><td class="td-linebottomrt">2.8%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file25.html">pdcoO&gt;pdcoO.merit</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">126</td><td class="td-linebottomrt">0.049 s</td><td class="td-linebottomrt">1.5%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file32.html">pdcoO&gt;pdcoO.step_to_boundary</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">252</td><td class="td-linebottomrt">0.046 s</td><td class="td-linebottomrt">1.4%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file35.html">pdcoO&gt;pdcoO.distrib</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.016 s</td><td class="td-linebottomrt">0.5%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file13.html">pdcoO&gt;pdcoO.categorize_bounds</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.014 s</td><td class="td-linebottomrt">0.4%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file33.html">LU&gt;LU.Print_results</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">63</td><td class="td-linebottomrt">0.002 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file12.html">LU&gt;LU.Print_param</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file34.html">LU&gt;LU.Reset_param</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">60</td><td class="td-linebottomrt">0.000 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file26.html">LU&gt;LU.Init_param</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.000 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.536 s</td><td class="td-linebottomrt">16.8%</td><td class="td-linebottomrt"><img src="file:///D:\matlab\toolbox\matlab\codetools\private\one-pixel.gif" width=17 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">3.192 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line875">875</a></td><td class="td-linebottomrt"><span class="mono">When both arguments are numeric scalars, consider replacing & with && for performance.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line879">879</a></td><td class="td-linebottomrt"><span class="mono">When both arguments are numeric scalars, consider replacing & with && for performance.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Total lines in function</td><td class="td-linebottomrt">525</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">174</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">351</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">267</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">84</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">76.07 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><table id="FunctionListingTable"><tr style="height:20px;"><th><pre><span style="color:#FF0000;">time</span> </pre></th><th><pre><span style="color:#0000FF;">Calls</span> </pre></th><th class="leftAligned" COLSPAN=2><pre><span> line</span></pre></th></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 625</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        function solve(o)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 626</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 627</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 628</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n   --------------------------------------------------------'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 629</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n   pdco.m                            Version of 23 Nov 2013'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 630</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n   Primal-dual barrier method to minimize a convex function'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 631</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 632</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n                                                           '); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 633</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n   Michael Saunders       SOL and ICME, Stanford University'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 634</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 635</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n                     Santiago Akle (ICME), Matt Zahr (ICME)'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 636</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n   --------------------------------------------------------\n'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 637</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 638</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 639</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %---------------------------------------------------------------------</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 640</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Decode A.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 641</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %---------------------------------------------------------------------</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 642</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.explicitA = isa(o.A, 'numeric');       % Not an opSpot.  Must be a matrix. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 643</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 644</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if o.explicitA </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 645</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    if issparse(o.A) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 646</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                        fprintf(o.file_id, '\nA is a sparse matrix'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 647</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                        nnzA = nnz(o.A); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 648</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                        fprintf(o.file_id, '\n\nm = %8d     n = %8d      nnz(A) = %9d', o.m, o.n, nnzA); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 649</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    else</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 650</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        fprintf(o.file_id, '\nA is a dense matrix');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 651</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        fprintf(o.file_id, '\n\nm = %8d     n = %8d', o.m, o.n);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 652</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 653</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                else</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 654</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    fprintf(o.file_id, '\nA is a linear operator');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 655</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    fprintf(o.file_id, '\n\nm = %8d     n = %8d', o.m, o.n);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 656</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 657</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 658</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 659</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            normb = norm(o.b , inf);   normx0 = norm(o.x0, inf); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 660</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            normy0 = norm(o.y0, inf);   normz0 = norm(o.z0, inf); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 661</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 662</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 663</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\nmax |b | = %8d     max |x0| = %8.1.0e', normb , normx0); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 664</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id,                '      xsize = %8.1.0e', o.xsize); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 665</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\nmax |y0| = %8d     max |z0| = %8.1.0e', normy0, normz0); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 666</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id,                '      zsize = %8.1.0e', o.zsize); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 667</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 668</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 669</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Initialize.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 670</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.zn = zeros(o.n, 1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 671</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.inner_itns = 0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 672</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.inner_total = 0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 673</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.inform = 0; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 674</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 675</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Set other parameters.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 676</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.eta = 1.0e-4;         % Linesearch tolerance for "sufficient descent" </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 677</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.maxf = 10;            % Linesearch backtrack limit (function evaluations) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 678</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.maxfail = 1;          % Linesearch failure limit (consecutive iterations) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 679</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.bigcenter = 1.0e+3;   % mu is reduced if center &lt; bigcenter </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 680</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.gamma = max(o.d1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 681</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.delta = max(o.d2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 682</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 683</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 684</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n\nx0min = %8g     featol = %8.1.0e', o.x0min, o.featol); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 685</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id,                  '      d1max = %8.1.0e', o.gamma); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 686</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id,  '\nz0min = %8g     opttol = %8.1.0e', o.z0min, o.opttol); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 687</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id,                  '      d2max = %8.1.0e', o.delta); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 688</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id,  '\nmu0 = %8.1.0e     steptol = %8g', o.mu0  , o.steptol); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 689</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id,                  '     bigcenter = %8g'  , o.bigcenter); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 690</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 691</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                Print_param(o); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 692</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 693</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 694</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Check for valid Method.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 695</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.time = cputime; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 696</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 697</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                tic </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 698</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 699</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 700</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Categorize bounds and allow for fixed variables by modifying b.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.014 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 701</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            categorize_bounds(o); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 702</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 703</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.nfix &gt; 0 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 704</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.x1 = o.zn;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 705</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.x1(o.fix) = o.bl(o.fix);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 706</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.r1 = o.A * o.x1;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 707</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.b = o.b - o.r1;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 708</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % At some stage, might want to look at normfix = norm(r1, inf);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 709</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 710</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 711</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Scale the input data.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 712</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % The scaled variables are</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 713</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    xbar = x / beta,</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 714</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    ybar = y / zeta,</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 715</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    zbar = z / zeta.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 716</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Define</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 717</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    theta = beta * zeta;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 718</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % The scaled function is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 719</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    phibar = (1 / theta) fbar(beta * xbar),</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 720</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    gradient = (beta / theta) grad,</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 721</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    Hessian = (beta2 / theta) hess.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 722</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.beta = o.xsize;   if o.beta == 0, o.beta = 1; end    % beta scales b, x. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 723</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.zeta = o.zsize;   if o.zeta == 0, o.zeta = 1; end    % zeta scales y, z. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 724</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.theta = o.beta * o.zeta;                             % theta scales obj. </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 725</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % (theta could be anything, but theta = beta * zeta makes</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 726</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % scaled grad = grad / zeta = 1 approximately if zeta is chosen right.)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 727</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 728</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.bl(o.fix) = o.bl(o.fix) / o.beta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 729</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.bu(o.fix) = o.bu(o.fix) / o.beta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.078 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 730</span><a name="Line730"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.bl(o.low) = o.bl(o.low) / o.beta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.059 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 731</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.bu(o.upp) = o.bu(o.upp) / o.beta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 732</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.d1 = o.d1 * (o.beta / sqrt(o.theta)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 733</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.d2 = o.d2 * (sqrt(o.theta) / o.beta); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 734</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 735</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.b = o.b / o.beta;   o.y0 = o.y0 / o.zeta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 736</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x0 = o.x0 / o.beta; o.z0 = o.z0 / o.zeta; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 737</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 738</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Initialize vectors that are not fully used if bounds are missing.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 739</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.rL = o.zn;   o.rU = o.zn; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 740</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.cL = o.zn;   o.cU = o.zn; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 741</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x1 = o.zn;   o.x2 = o.zn; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 742</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.z1 = o.zn;   o.z2 = o.zn; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 743</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.dx1 = o.zn;   o.dx2 = o.zn; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 744</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.dz1 = o.zn;   o.dz2 = o.zn; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 745</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 746</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Initialize x, y, z1, z2, objective, etc.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 747</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 10 Aug 2003: z isn't needed here -- just at end for output.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 748</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 03 Jul 2008: Use pos to ensure that x = x1 for vanilla bounds.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 749</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              The linear constraints x(pos) - x1(pos) = bl(pos) = 0</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 750</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              should then remain satisfied, so we'll have x(pos) &gt; 0</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 751</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              throughout.  At last, no danger of evaluating log(x)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 752</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              at negative x values.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 753</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 26 Feb 2010: zlo and zup now used in place of pos.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 754</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              See 26 Feb 2010 note above.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 755</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x = o.x0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 756</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.y = o.y0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 757</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x(o.fix) = o.bl(o.fix); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.005 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 758</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x(o.low) = max(o.x(o.low), o.bl(o.low)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.004 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 759</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x(o.upp) = min(o.x(o.upp), o.bu(o.upp)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.005 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 760</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x1(o.low) = max(o.x(o.low) - o.bl(o.low), o.x0min); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.005 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 761</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x2(o.upp) = max(o.bu(o.upp) - o.x(o.upp), o.x0min); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 762</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.z1(o.low) = max(o.z0(o.low), o.z0min); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 763</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.z2(o.upp) = max(-o.z0(o.upp), o.z0min); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 764</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x(o.zlo) = o.x1(o.zlo); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 765</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x(o.zup) = -o.x2(o.zup); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 766</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.029 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 767</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            [o.obj, o.grad, o.hess] = o.slack.obj(o.x*o.beta); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 768</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            [mH, nH] = size(o.hess); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 769</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.diagHess </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 770</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                if mH &gt; 1 &amp;&amp; nH &gt; 1</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 771</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    fprintf('\n Warning: Using only diagonal part of hess from pdObj\n');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 772</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.hess = diag(o.hess);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 773</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                end</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 774</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 775</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if mH ~= o.n &amp;&amp; nH ~= o.n </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 776</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    error('Hessian size mismatch');</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 777</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 778</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 779</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 780</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.obj = o.obj / o.theta; % Scaled obj. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 781</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.grad = o.grad*(o.beta / o.theta) + (o.d1.^2) .* o.x; % grad includes x regularization. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 782</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.H = o.hess * (o.beta * o.beta / o.theta); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 783</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.diagHess </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 784</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.H = o.H + (o.d1.^2); % H includes x regularization.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 785</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 786</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                o.H = o.H + sparse(1:o.n, 1:o.n, (o.d1.^2), o.n, o.n); % H includes x regularization. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 787</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 788</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 789</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Compute primal and dual feasibility residuals:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 790</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    r1 = b - A*x - d2.^2*y</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 791</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    r2 = grad - A'*y + (z2-z1)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 792</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    rL = bl - x + x1</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.022 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 793</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            feasibility_resids(o); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 794</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 795</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Initialize mu and complementarity residuals:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 796</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    cL = mu*e - X1*z1.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 797</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %    cU = mu*e - X2*z2.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 798</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 799</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 25 Jan 2001: Now that b and obj are scaled (and hence x, y, z),</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 800</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              we should be able to use mufirst = mu0 (absolute value).</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 801</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              0.1 worked poorly on StarTest1 with x0min = z0min = 0.1.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 802</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 29 Jan 2001: We might as well use mu0 = x0min * z0min;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 803</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              so that most variables are centered after a warm start.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 804</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 29 Sep 2002: Use mufirst = mu0*(x0min * z0min),</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 805</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              regarding mu0 as a scaling of the initial center.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 806</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 07 Aug 2003: mulast is controlled by opttol.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 807</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %              mufirst should not be smaller.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 808</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 10 Aug 2003: Revert to mufirst = mu0 (absolute value).</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 809</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 12 Jan 2006: If mu0 &lt;= 0, reset it to the average complementarity.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 810</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.mu0 &lt;= 0 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 811</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                clow = o.x1(o.low) .* o.z1( o.low);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 812</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                cupp = o.x2(o.upp) .* o.z2( o.upp);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 813</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.mu0 = (sum(clow) + sum(cupp)) / (length(o.low) + length(o.upp));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 814</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.mu0 = o.mu0*0.1;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 815</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                clear clow cupp</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 816</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 817</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 818</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % mufirst = mu0 * (x0min * z0min);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 819</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.mufirst = o.mu0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 820</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.mulast = 0.1 * o.opttol; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 821</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.mufirst = max(o.mufirst, o.mulast); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 822</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.mu = o.mufirst; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.006 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 823</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            complementarity_resids(o); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 824</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 825</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Compute initial merit function value.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.005 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 826</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            merit(o); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 827</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 828</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Initialize other things.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 829</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.PDitns = 0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 830</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            converged = 0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 831</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            Init_param(o); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 832</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 833</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %  Iteration log.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 834</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.nfail = 0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 835</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.regterm = norm(o.d1 .* o.x)^2 + norm(o.d2 .* o.y)^2; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 836</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.objreg = o.obj + 0.5 * o.regterm; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 837</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.objtrue = o.objreg * o.theta; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 838</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 839</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 840</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                head1 = '\n\nItn   mu stepx stepz  Pinf  Dinf'; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 841</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                head2 = '  Cinf   Objective    nf  center'; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 842</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, [ head1 head2 o.head3 ]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 843</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n%3g                 ', o.PDitns       ); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 844</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '%6.1f%6.1f', log10(o.Pinf), log10(o.Dinf)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 845</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '%6.1f%15.7e', log10(o.Cinf0), o.objtrue); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 846</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '   %8.1f', o.center); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 847</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 848</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 849</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Main loop.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 850</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 851</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.xmem = o.x; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 852</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.zmem = o.z; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 853</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.objmem = o.obj; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 854</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 855</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            while ~converged </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 856</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                o.PDitns = o.PDitns + 1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 857</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 858</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if o.check_residu </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 859</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.opt_residu = [o.opt_residu o.Cinf0];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 860</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.evolution_mu =  [o.evolution_mu o.mu];</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 861</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 862</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % Compute step. This is performed in a subclass.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 863</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                tmp1 = size(o.eigenvalue); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.005 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 864</span><a name="Line864"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FF8080; padding:1px;">                Solve_Newton(o); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 865</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                tmp2 = size(o.eigenvalue); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 866</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if o.check_eigenvalue_other_formulation &amp;&amp; isequal(tmp1,tmp2) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 867</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.eigenvalue = [o.eigenvalue eigs(o.M, size(o.M,1))];</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 868</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 869</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 870</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                 if o.save_evolution</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 871</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                     display_and_save_evolution(o.x, o.PDitns);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 872</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                 end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 873</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 874</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % Add to save the evolution of the conditionning</span><br/></pre></td></tr><tr><a name="Line875"></a><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 875</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if o.check_cond &amp; not(isempty(o.eigenvalue)) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 876</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    lambda_min = min(abs(o.eigenvalue(:,end)));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 877</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    lambda_max = max(abs(o.eigenvalue(:,end)));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 878</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.cond = [o.cond lambda_max/lambda_min];</span><br/></pre></td></tr><tr><a name="Line879"></a><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 879</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                elseif o.check_cond &amp; isempty(o.eigenvalue) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 880</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    lambda_min = min(abs(eigs(o.M, min(min(size(o.M)),100), "smallestabs")));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 881</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    lambda_max = max(abs(eigs(o.M, min(min(size(o.M)),100), "largestabs")));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 882</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.cond = [o.cond lambda_max/lambda_min ];</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 883</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 884</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 885</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if o.inform == 4 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 886</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    break</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 887</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 888</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 889</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % Find the maximum step size.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 890</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % 13 Aug 2003: We need stepxL, stepxU also to keep x feasible</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 891</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %              so that nonlinear functions are defined.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 892</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % 18 Nov 2003: But this gives stepx = 0 for lptest.  (??)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.026 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 893</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                stepx1 = step_to_boundary(o, o.x1(o.low), o.dx1(o.low)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 894</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                stepx2 = step_to_boundary(o, o.x2(o.upp), o.dx2(o.upp)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.023 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 895</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                stepz1 = step_to_boundary(o, o.z1(o.low), o.dz1(o.low)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.019 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 896</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                stepz2 = step_to_boundary(o, o.z2(o.upp), o.dz2(o.upp)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 897</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %  stepxL = step_to_boundary( x(low),  dx(low));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 898</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %  stepxU = step_to_boundary( x(upp),  dx(upp));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 899</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %  stepx = min([stepx1,   stepx2,   stepxL,   stepxU]);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 900</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                stepx = min([stepx1, stepx2]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 901</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                stepz = min([stepz1, stepz2]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 902</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                stepx = min([o.steptol * stepx, 1]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 903</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                stepz = min([o.steptol * stepz, 1]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 904</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if o.stepSame                      % For NLPs, force same step </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 905</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    stepx = min(stepx, stepz);   % (true Newton method) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 906</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    stepz = stepx; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 907</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 908</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 909</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % Backtracking linesearch.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 910</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fail = true; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 911</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                o.nf = 0; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 912</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 913</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                while o.nf &lt; o.maxf </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 914</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.nf = o.nf + 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.011 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 915</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.x1(o.low) = o.x1(o.low) + stepx * o.dx1(o.low); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.012 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 916</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.x2(o.upp) = o.x2(o.upp) + stepx * o.dx2(o.upp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.013 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 917</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.z1(o.low) = o.z1(o.low) + stepz * o.dz1(o.low); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.013 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 918</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.z2(o.upp) = o.z2(o.upp) + stepz * o.dz2(o.upp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 919</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.x = o.x + stepx * o.dx; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 920</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.y = o.y + stepz * o.dy; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 921</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.x(o.zlo) = o.x1(o.zlo); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 922</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.x(o.zup) = -o.x2(o.zup); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 923</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 924</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                     if o.check_mask</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 925</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                         tmp = o.x(1:length(o.mask));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 926</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                         tmp(o.mask == 0) = 0;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 927</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                         o.x(1:length(o.mask)) = tmp;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 928</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                         %                     o.x(1:length(o.mask)) = o.x(1:length(o.mask)).*o.mask;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 929</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                     end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 930</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 931</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.167 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 932</span><a name="Line932"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    [o.obj, o.grad, o.hess] = o.slack.obj(o.x * o.beta); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 933</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    if o.diagHess </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 934</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        if mH&gt;1 &amp;&amp; nH&gt;1</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 935</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                            o.hess = diag(o.hess);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 936</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        end</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 937</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 938</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.obj = o.obj / o.theta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.004 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 939</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.grad = o.grad * (o.beta / o.theta) + (o.d1.^2) .* o.x; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 940</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.H = o.hess * (o.beta * o.beta / o.theta); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 941</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    if o.diagHess </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 942</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        o.H = o.H + (o.d1.^2); % H includes x regularization.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 943</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.022 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 944</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                        o.H = o.H + sparse(1:o.n, 1:o.n, (o.d1.^2), o.n, o.n); % H includes x regularization. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 945</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 946</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.220 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 947</span><a name="Line947"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    feasibility_resids(o); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.036 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 948</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    complementarity_resids(o); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.023 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 949</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    merit(o); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 950</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.step = min(stepx, stepz); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 951</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 952</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    if ~o.backtrack || fmeritnew &lt;= (1 - o.eta*o.step)*o.fmerit </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 953</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                        fail = false; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 954</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                        break; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 955</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 956</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 957</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    % Merit function didn't decrease.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 958</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    % Restore variables to previous values.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 959</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    % (This introduces a little error, but save lots of space.)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 960</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.x = o.x - stepx * o.dx;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 961</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.y = o.y - stepz * o.dy;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 962</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.x1(o.low) = o.x1(o.low) - stepx * o.dx1(o.low);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 963</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.x2(o.upp) = o.x2(o.upp) - stepx * o.dx2(o.upp);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 964</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.z1(o.low) = o.z1(o.low) - stepz * o.dz1(o.low);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 965</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.z2(o.upp) = o.z2(o.upp) - stepz * o.dz2(o.upp);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 966</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.x(o.zlo) = o.x1(o.zlo);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 967</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.x(o.zup) = -o.x2(o.zup);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 968</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 969</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    % Back-track.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 970</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    % If it's the first time,</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 971</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    % make stepx and stepz the same.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 972</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    if o.nf == 1 &amp;&amp; stepx ~= stepz</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 973</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        stepx = o.step;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 974</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    elseif o.nf &lt; o.maxf</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 975</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        stepx = stepx / 2;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 976</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 977</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    stepz = stepx;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 978</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 979</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 980</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if fail </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 981</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    fprintf(o.file_id, '\n     Linesearch failed (nf too big)');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 982</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.nfail = o.nfail + 1;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 983</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 984</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.nfail = 0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 985</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 986</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 987</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                 if o.check_mask</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 988</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                     tmp = o.x(1:length(o.mask));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 989</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                     tmp(o.mask == 0) = 0;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 990</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                     o.x(1:length(o.mask)) = tmp;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 991</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                     %                     o.x(1:length(o.mask)) = o.x(1:length(o.mask)).*o.mask;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 992</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                 end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 993</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 994</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % Set convergence measures.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.005 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 995</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                o.regterm = norm(o.d1.*o.x)^2 + norm(o.d2.*o.y)^2; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 996</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                o.objreg = o.obj + 0.5 * o.regterm; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 997</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                o.objtrue = o.objreg * o.theta; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 998</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 999</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                primalfeas = o.Pinf &lt;= o.featol; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1000</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                dualfeas = o.Dinf &lt;= o.featol; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1001</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                complementary = o.Cinf0 &lt;= o.opttol; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1002</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                enough = o.PDitns &gt;= 4; % Prevent premature termination. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1003</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                converged = primalfeas &amp; dualfeas &amp; complementary &amp; enough; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1004</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1005</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % Iteration log.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1006</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.007 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1007</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    str1 = sprintf('\n%3g%5.1f', o.PDitns, log10(o.mu)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.004 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1008</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    str2 = sprintf('%6.3f%6.3f', stepx, stepz); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1009</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    if stepx &lt; 0.001 || stepz &lt; 0.001 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1010</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        str2 = sprintf('%6.1.0e%6.1.0e', stepx, stepz);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1011</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1012</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    str3 = sprintf('%6.1f%6.1f', log10(o.Pinf), log10(o.Dinf)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1013</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    str4 = sprintf('%6.1f%15.7e', log10(o.Cinf0), o.objtrue); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1014</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    str5 = sprintf('%3g%8.1f', o.nf, o.center); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1015</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    if o.center &gt; 99999 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1016</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        str5 = sprintf('%3g%8.1.0e', o.nf, o.center);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1017</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.009 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1018</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    fprintf(o.file_id, [str1 str2 str3 str4 str5]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1019</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    Print_results(o); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1020</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1021</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1022</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % Test for termination.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1023</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if converged </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1024</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1025</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                        fprintf(o.file_id, '\n   Converged'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1026</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1027</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                elseif o.PDitns &gt;= o.maxitn </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1028</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    if o.Prilev &gt; 0</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1029</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        fprintf(o.file_id, '\n   Too many iterations');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1030</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1031</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.inform = 1;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1032</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    break</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1033</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                elseif o.nfail &gt;= o.maxfail </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1034</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    if o.Prilev &gt; 0</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1035</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        fprintf(o.file_id, '\n   Too many linesearch failures');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1036</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1037</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.inform = 2;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1038</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    break</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1039</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                elseif o.step &lt;= 1.0e-16 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1040</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    if o.Prilev &gt; 0</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1041</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        fprintf(o.file_id, '\nStep lengths too small');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1042</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1043</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.inform = 3;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1044</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    break</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1045</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                else </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1046</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1047</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                     if o.check_mask</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1048</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                         tmp = o.x(1:length(o.mask));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1049</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                         tmp(o.mask == 0) = 0;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1050</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                         o.x(1:length(o.mask)) = tmp;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1051</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                         %                     o.x(1:length(o.mask)) = o.x(1:length(o.mask)).*o.mask;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1052</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                     end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1053</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1054</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1055</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    % Reduce mu, and reset certain residuals.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1056</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    stepmu = min(stepx, stepz); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1057</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    stepmu = min(stepmu, o.steptol); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1058</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    muold = o.mu; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1059</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    mumin = 0.1 * max([o.Pinf o.Dinf o.Cinf]); % Target mu shouldn't be too small. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1060</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    mumin = min(o.mu, mumin); % mu should be monotonic. </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1061</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1062</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.mu = o.mu - stepmu * o.mu; % mu being treated as a variable. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1063</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    if o.center &gt;= o.bigcenter, o.mu = muold; end  % Keep old mu if far from center. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1064</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.mu = max(o.mu, mumin); % 04 May 2008: No smaller than target. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1065</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.mu = max(o.mu, o.mulast); % 13 Jun 1998: No need for smaller mu. </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1066</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1067</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    % mutrad = mu0 * (sum(Xz) / n); % 24 May 1998: Traditional value, but</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1068</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    % mu = min(mu, mutrad); % it seemed to decrease mu too much.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1069</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1070</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.mu = max(o.mu, o.mulast);  % 13 Jun 1998: No need for smaller mu. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.050 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1071</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    complementarity_resids(o); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.022 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1072</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    merit(o); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">     60 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1073</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    Reset_param(o); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1074</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1075</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1076</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if o.mem </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1077</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.xmem = [o.xmem o.x];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1078</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.zmem = [o.zmem o.z];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1079</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    o.objmem = [o.objmem o.obj];</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1080</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">     63 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1081</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1082</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %---------------------------------------------------------------------</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1083</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % End of main loop.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1084</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %---------------------------------------------------------------------</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1085</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1086</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Reconstruct z.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1087</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x(o.fix) = 0; % Exclude x(fix) temporarily from |x|. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1088</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.z = zeros(o.n, 1); % Exclude z(fix) also. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1089</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.z(o.low) = o.z1(o.low); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1090</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.z(o.upp) = o.z(o.upp) - o.z2(o.upp); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1091</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1092</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Print statistics.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1093</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1094</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '\n\nmax |x| = %10.3f', norm(o.x, inf)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1095</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '    max |y| = %10.3f', norm(o.y, inf)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1096</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '    max |z| = %10.3f', norm(o.z, inf));  % excludes z(fix) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1097</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '   scaled'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1098</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1099</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1100</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.bl(o.fix) = o.bl(o.fix) * o.beta; % Unscale bl, bu, x, y, z. </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1101</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.bu(o.fix) = o.bu(o.fix) * o.beta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.058 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1102</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.bl(o.low) = o.bl(o.low) * o.beta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.060 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1103</span><a name="Line1103"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.bu(o.upp) = o.bu(o.upp) * o.beta; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1104</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1105</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.x = o.x * o.beta; o.y = o.y * o.zeta; o.z = o.z * o.zeta; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1106</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1107</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1108</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id,  '\nmax |x| = %10.3f', norm(o.x, inf)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1109</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '    max |y| = %10.3f', norm(o.y, inf)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1110</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, '    max |z| = %10.3f', norm(o.z, inf));  % excludes z(fix) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1111</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, ' unscaled'); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1112</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1113</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1114</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Reconstruct x(fix) and z(fix).</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1115</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.r2 = o.A' * o.y ; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1116</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.nfix &gt; 0 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1117</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.x(o.fix) = o.bl(o.fix);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1118</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.z(o.fix) = o.grad(o.fix) - o.r2(o.fix); % z = grad - A'y</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1119</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.z1(o.fix) = max(o.z(o.fix), 0);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1120</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.z2(o.fix) = max(-o.z(o.fix), 0);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1121</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1122</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1123</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Reconstruct b.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1124</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.b = o.b * o.beta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1125</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.nfix &gt; 0 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1126</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.x1 = zeros(o.n, 1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1127</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.x1(o.fix) = o.bl(o.fix);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1128</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.r1 = o.A *o.x1 ;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1129</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                o.b = o.b + o.r1;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1130</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                if o.Prilev &gt; 0</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1131</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    fprintf(o.file_id, '\nmax |x| and max |z| exclude fixed variables');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1132</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                end</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1133</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1134</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1135</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Evaluate function at final point.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1136</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Recompute all of z.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1137</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % 03 Apr 2010: z now includes (d1.^2).*x from the primal regularization.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.009 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1138</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            [o.obj, o.grad, o.hess] = o.slack.obj(o.x); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1139</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.z = o.grad + (o.d1.^2) .* o.x - o.r2; % z = grad + (d1.^2).*x - A'y </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1140</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1141</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            o.time = cputime - o.time; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1142</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if o.Prilev &gt; 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1143</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                fprintf(o.file_id, ... </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1144</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    '\nPDitns = %10g %sitns = %10g    cputime = %10.1f', ...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1145</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    o.PDitns, o.solver, o.inner_total, o.time); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1146</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                distrib(o, abs(o.x), abs(o.z)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1147</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                toc </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1148</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.001 </span></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1149</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr></table><p><p>Other subfunctions in this file are not included in this listing.</body></html>