
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>modify_d1_d2_K35</title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-05-04"><meta name="DC.source" content="modify_d1_d2_K35.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Clean</a></li><li><a href="#2">Setup 1</a></li><li><a href="#3">Setup 2</a></li><li><a href="#4">Check eigenvalues and compare method</a></li><li><a href="#5">Loop</a></li></ul></div><h2 id="1">Clean</h2><pre class="codeinput">clear <span class="string">all</span>
close <span class="string">all</span>
clc
</pre><h2 id="2">Setup 1</h2><pre class="codeinput">pdcoo_home = pwd;

addpath(pdcoo_home);
addpath(fullfile(pdcoo_home, <span class="string">'Formulations'</span>));
addpath(fullfile(pdcoo_home, <span class="string">'Solvers'</span>));
addpath(fullfile(pdcoo_home, <span class="string">'readmps'</span>));
addpath(fullfile(pdcoo_home, <span class="string">'Tools'</span>));
addpath(fullfile(pdcoo_home, <span class="string">'Problems\MPS'</span>));
addpath(fullfile(pdcoo_home, <span class="string">'Validation-eigenvalue'</span>));
p = genpath(fullfile(pdcoo_home, <span class="string">'addons'</span>));
addpath(p);
p = genpath(fullfile(pdcoo_home, <span class="string">'Results'</span>));
addpath(p);
<span class="keyword">if</span> exist(<span class="string">'Variants'</span>, <span class="string">'dir'</span>) ~= 7
    mkdir(<span class="string">'Variants'</span>);
<span class="keyword">end</span>
addpath(fullfile(pdcoo_home, <span class="string">'Variants'</span>));
addpath(fullfile(pdcoo_home, <span class="string">'Test'</span>));
</pre><h2 id="3">Setup 2</h2><pre class="codeinput">import <span class="string">model.lpmodel</span>;
import <span class="string">model.slackmodel</span>;

options_pdco.file_id = 1;

formulation1 = <span class="string">'K25'</span>;
solver = <span class="string">'LU'</span>;
classname1 = build_variant(pdcoo_home, formulation1, solver);

formulation2 = <span class="string">'K35'</span>;
solver = <span class="string">'LU'</span>;
classname2 = build_variant(pdcoo_home, formulation2, solver);

formulation3 = <span class="string">'K2'</span>;
solver = <span class="string">'LU'</span>;
classname3 = build_variant(pdcoo_home, formulation3, solver);

path_qp = <span class="string">''</span>;
list_problem = {<span class="string">'D:\git_repository\Stage-K2.5\Problems\qp_prob\qafiro.qps'</span>}



n_problem = length(list_problem);

options_pdco.d1 = 1.0e-2;
options_pdco.d2 = 1.0e-2;
options_pdco.OptTol = 1.0e-9;
options_solv.atol1 = 1.0e-4;
options_solv.atol2 = 1.0e-10;
options_solv.itnlim = 10;
options_pdco.Print = 1;

fprintf(options_pdco.file_id, <span class="keyword">...</span>
    <span class="string">'\n    Name    Objectif   Presid   Dresid   Cresid   PDitns   Inner     Time      D2 * r\n\n'</span>);

result = zeros(9,3,n_problem);
</pre><pre class="codeoutput">
variants_dir =

    'D:\git_repository\Stage-K2.5\Variants'


variants_dir =

    'D:\git_repository\Stage-K2.5\Variants'


variants_dir =

    'D:\git_repository\Stage-K2.5\Variants'


list_problem =

  1&times;1 cell array

    {'D:\git_repository\Stage-K2.5\Problems\qp_prob\qafiro.qps'}


    Name    Objectif   Presid   Dresid   Cresid   PDitns   Inner     Time      D2 * r

</pre><h2 id="4">Check eigenvalues and compare method</h2><pre class="codeinput">n_problem = min(n_problem, 20000);
check_eigenvalue = 1;
check_eigenvalueK35 = 1;
show_one_graphic = 0; <span class="comment">% = 1  need check_eigenvalue = 1</span>
show_all_graphic = 0; <span class="comment">% = 1  need check_eigenvalue = 1</span>
check_cond = 1;
compare_formulations = 0;
check_residu = 0;
check_all_residu = 0; <span class="comment">% = 1  need check_residu = 1</span>
</pre><h2 id="5">Loop</h2><pre class="codeinput">clc

d1 = 10^-4;
d2 = [0 10^-16 10^-4 10^-2 10^-1 1];
options_pdco.d1 = d1;
<span class="keyword">for</span> j = 1:length(d2)
    options_pdco.d2 = d2(j);

    mps_name = list_problem{1};

    <span class="comment">% Read .mps file</span>
    mps_stru = readmps(mps_name);
    lp = mpstolp(mps_stru);
    slack = slackmodel(lp);
    Anorm = normest(slack.gcon(slack.x0), 1.0e-3);

    options_pdco.x0 = slack.x0;
    options_pdco.x0(slack.jLow) = slack.bL(slack.jLow) + 1;
    options_pdco.x0(slack.jUpp) = slack.bU(slack.jUpp) - 1;
    options_pdco.x0(slack.jTwo) = (slack.bL(slack.jTwo) + slack.bU(slack.jTwo)) / 2;
    options_pdco.xsize = max(norm(options_pdco.x0, inf), 1);
    options_pdco.zsize = max(norm(slack.gobj(slack.x0), inf) + sqrt(slack.n) * Anorm, 1);
    options_pdco.z0 = options_pdco.zsize * ones(slack.n, 1);
    options_pdco.y0 = zeros(slack.m, 1);
    options_pdco.mu0 = options_pdco.zsize;
    options_pdco.Maxiter = min(max(30, slack.n), 100);
    options_pdco.check_eigenvalue = check_eigenvalue;
    options_pdco.check_eigenvalueK35 = check_eigenvalueK35;
    options_pdco.check_residu = check_residu;
    options_pdco.check_cond = check_cond;
    options_form = struct();

    Problem1 = eval([classname1, <span class="string">'(slack, options_pdco,options_form,options_solv)'</span>]);
    Problem1.solve;
    Problem2 = eval([classname2, <span class="string">'(slack, options_pdco,options_form,options_solv)'</span>]);
    Problem2.solve;

    show_eigenvalue(Problem1.eigenvalue, Problem1.limit, d1, d2(j))
    show_eigenvalueK35(Problem2.eigenvalue, d1, d2(j))



<span class="keyword">end</span>

fclose(<span class="string">'all'</span>);
</pre><pre class="codeoutput">ROWS Section
COLUMNS section

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  7.0252092e+03  1    87.6      235 x2
  2  1.8 0.106 0.106   1.2  -0.1   1.5 -7.7080569e+02  1   240.8
  3  1.7 0.190 0.190   1.1  -0.1   1.4  5.7807433e+03  1    37.3
  4  1.6 0.477 0.477   0.8  -0.4   1.6 -4.3053742e+02  1    79.5
  5  1.3 0.752 0.752   0.2  -1.0   1.5  1.6644101e+03  1    63.4
  6  0.7 0.901 0.901  -0.8  -2.0   0.9 -5.6327324e+01  1    46.1
  7 -0.3 0.942 0.942  -2.0  -3.3   0.4 -3.7931167e+01  1    58.4
  8 -0.7 1.000 1.000 -13.5 -13.4  -0.4 -2.3859196e+01  1     3.9
  9 -1.7 1.000 1.000 -15.6 -14.3  -1.5 -1.9726679e+01  1     3.2
 10 -2.9 1.000 1.000 -14.8 -15.2  -2.4 -3.8321808e+01  1     5.5
 11 -3.6 0.813 0.813 -14.4 -15.9  -3.0 -1.2350532e+02  1   110.3
 12 -4.1 0.479 0.479 -14.8 -16.1  -3.2 -2.2313770e+02  1   181.6
 13 -4.3 0.612 0.612 -14.8 -16.6  -3.6 -3.4480764e+02  1   198.1
 14 -4.7 0.906 0.906 -15.3 -16.9  -4.2 -4.3605767e+02  1    38.1
 15 -5.4 0.803 0.803 -15.5 -16.9  -4.7 -4.5629055e+02  1    76.3
 16 -5.8 0.943 0.943 -15.3 -16.6  -5.3 -4.6297949e+02  1    28.2
 17 -6.5 1.000 1.000 -15.2 -17.2  -6.4 -4.6445903e+02  1     1.3
 18 -8.3 0.994 0.994 -15.6 -16.9  -8.0 -4.6474114e+02  1     3.4
 19 -9.3 0.868 0.868 -16.0 -16.9  -8.6 -4.6474603e+02  1    69.9
 20 -9.7 0.675 0.675 -15.9 -17.0  -8.9 -4.6474674e+02  1   149.7Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.900084e-16. 

 21-10.0 1.000 1.000 -16.0 -16.6  -9.6 -4.6474719e+02  1     4.6
   Converged

max |x| =      1.002    max |y| =      0.025    max |z| =      0.171   scaled
max |x| =    500.000    max |y| =      1.458    max |z| =     10.000 unscaled
PDitns =         21     LUitns =          0    cputime =        0.9

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1        15
[    0.1,       1)         0        13
[   0.01,     0.1)         0         1
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)         0         0
[  1e-05,  0.0001)         2         9
[  1e-06,   1e-05)        24        13
[      0,   1e-06)         1         0Elapsed time is 0.725843 seconds.

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  7.0252092e+03  1    87.6      337 x2
  2  1.8 0.106 0.106   1.2  -0.1   1.5 -7.7080569e+02  1   240.8
  3  1.7 0.190 0.190   1.1  -0.1   1.4  5.7807433e+03  1    37.3
  4  1.6 0.477 0.477   0.8  -0.4   1.6 -4.3053742e+02  1    79.5
  5  1.3 0.752 0.752   0.2  -1.0   1.5  1.6644101e+03  1    63.4
  6  0.7 0.901 0.901  -0.8  -2.0   0.9 -5.6327324e+01  1    46.1
  7 -0.3 0.942 0.942  -2.0  -3.3   0.4 -3.7931167e+01  1    58.4
  8 -0.7 1.000 1.000 -13.6 -13.6  -0.4 -2.3859196e+01  1     3.9
  9 -1.7 1.000 1.000 -15.7 -14.3  -1.5 -1.9726679e+01  1     3.2
 10 -2.9 1.000 1.000 -14.6 -15.4  -2.4 -3.8321808e+01  1     5.5
 11 -3.6 0.813 0.813 -14.7 -16.1  -3.0 -1.2350532e+02  1   110.3
 12 -4.1 0.479 0.479 -15.0 -16.4  -3.2 -2.2313770e+02  1   181.6
 13 -4.3 0.612 0.612 -15.0 -16.6  -3.6 -3.4480764e+02  1   198.1
 14 -4.7 0.906 0.906 -15.4 -16.6  -4.2 -4.3605767e+02  1    38.1
 15 -5.4 0.803 0.803 -15.8 -16.3  -4.7 -4.5629055e+02  1    76.3
 16 -5.8 0.943 0.943 -15.4 -17.0  -5.3 -4.6297949e+02  1    28.2
 17 -6.5 1.000 1.000 -15.3 -16.9  -6.4 -4.6445903e+02  1     1.3
 18 -8.3 0.994 0.994 -15.7 -16.9  -8.0 -4.6474114e+02  1     3.4
 19 -9.3 0.868 0.868 -15.9 -16.6  -8.6 -4.6474603e+02  1    69.9
 20 -9.7 0.675 0.675 -15.8 -17.2  -8.9 -4.6474674e+02  1   149.7Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.120252e-17. 

 21-10.0 1.000 1.000 -15.9 -16.6  -9.6 -4.6474719e+02  1     4.6
   Converged

max |x| =      1.002    max |y| =      0.025    max |z| =      0.171   scaled
max |x| =    500.000    max |y| =      1.458    max |z| =     10.000 unscaled
PDitns =         21     LUitns =          0    cputime =        0.5

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1        15
[    0.1,       1)         0        13
[   0.01,     0.1)         0         1
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)         0         0
[  1e-05,  0.0001)         2         9
[  1e-06,   1e-05)        24        13
[      0,   1e-06)         1         0Elapsed time is 0.168649 seconds.
ROWS Section
COLUMNS section

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  7.0252092e+03  1    87.6      235 x2
  2  1.8 0.106 0.106   1.2  -0.1   1.5 -7.7080569e+02  1   240.8
  3  1.7 0.190 0.190   1.1  -0.1   1.4  5.7807433e+03  1    37.3
  4  1.6 0.477 0.477   0.8  -0.4   1.6 -4.3053742e+02  1    79.5
  5  1.3 0.752 0.752   0.2  -1.0   1.5  1.6644101e+03  1    63.4
  6  0.7 0.901 0.901  -0.8  -2.0   0.9 -5.6327324e+01  1    46.1
  7 -0.3 0.942 0.942  -2.0  -3.3   0.4 -3.7931167e+01  1    58.4
  8 -0.7 1.000 1.000 -13.5 -13.4  -0.4 -2.3859196e+01  1     3.9
  9 -1.7 1.000 1.000 -15.6 -14.3  -1.5 -1.9726679e+01  1     3.2
 10 -2.9 1.000 1.000 -14.8 -15.2  -2.4 -3.8321808e+01  1     5.5
 11 -3.6 0.813 0.813 -14.4 -15.9  -3.0 -1.2350532e+02  1   110.3
 12 -4.1 0.479 0.479 -14.8 -16.1  -3.2 -2.2313770e+02  1   181.6
 13 -4.3 0.612 0.612 -14.8 -16.6  -3.6 -3.4480764e+02  1   198.1
 14 -4.7 0.906 0.906 -15.3 -16.9  -4.2 -4.3605767e+02  1    38.1
 15 -5.4 0.803 0.803 -15.5 -16.9  -4.7 -4.5629055e+02  1    76.3
 16 -5.8 0.943 0.943 -15.3 -16.6  -5.3 -4.6297949e+02  1    28.2
 17 -6.5 1.000 1.000 -15.2 -17.2  -6.4 -4.6445903e+02  1     1.3
 18 -8.3 0.994 0.994 -15.6 -16.9  -8.0 -4.6474114e+02  1     3.4
 19 -9.3 0.868 0.868 -16.0 -16.9  -8.6 -4.6474603e+02  1    69.9
 20 -9.7 0.675 0.675 -15.9 -17.0  -8.9 -4.6474674e+02  1   149.7Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.900084e-16. 

 21-10.0 1.000 1.000 -16.0 -16.6  -9.6 -4.6474719e+02  1     4.6
   Converged

max |x| =      1.002    max |y| =      0.025    max |z| =      0.171   scaled
max |x| =    500.000    max |y| =      1.458    max |z| =     10.000 unscaled
PDitns =         21     LUitns =          0    cputime =        0.4

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1        15
[    0.1,       1)         0        13
[   0.01,     0.1)         0         1
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)         0         0
[  1e-05,  0.0001)         2         9
[  1e-06,   1e-05)        24        13
[      0,   1e-06)         1         0Elapsed time is 0.220706 seconds.

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  7.0252092e+03  1    87.6      337 x2
  2  1.8 0.106 0.106   1.2  -0.1   1.5 -7.7080569e+02  1   240.8
  3  1.7 0.190 0.190   1.1  -0.1   1.4  5.7807433e+03  1    37.3
  4  1.6 0.477 0.477   0.8  -0.4   1.6 -4.3053742e+02  1    79.5
  5  1.3 0.752 0.752   0.2  -1.0   1.5  1.6644101e+03  1    63.4
  6  0.7 0.901 0.901  -0.8  -2.0   0.9 -5.6327324e+01  1    46.1
  7 -0.3 0.942 0.942  -2.0  -3.3   0.4 -3.7931167e+01  1    58.4
  8 -0.7 1.000 1.000 -13.6 -13.6  -0.4 -2.3859196e+01  1     3.9
  9 -1.7 1.000 1.000 -15.7 -14.3  -1.5 -1.9726679e+01  1     3.2
 10 -2.9 1.000 1.000 -14.6 -15.4  -2.4 -3.8321808e+01  1     5.5
 11 -3.6 0.813 0.813 -14.7 -16.1  -3.0 -1.2350532e+02  1   110.3
 12 -4.1 0.479 0.479 -15.0 -16.4  -3.2 -2.2313770e+02  1   181.6
 13 -4.3 0.612 0.612 -15.0 -16.6  -3.6 -3.4480764e+02  1   198.1
 14 -4.7 0.906 0.906 -15.4 -16.6  -4.2 -4.3605767e+02  1    38.1
 15 -5.4 0.803 0.803 -15.8 -16.3  -4.7 -4.5629055e+02  1    76.3
 16 -5.8 0.943 0.943 -15.4 -17.0  -5.3 -4.6297949e+02  1    28.2
 17 -6.5 1.000 1.000 -15.3 -16.9  -6.4 -4.6445903e+02  1     1.3
 18 -8.3 0.994 0.994 -15.7 -16.9  -8.0 -4.6474114e+02  1     3.4
 19 -9.3 0.868 0.868 -15.9 -16.6  -8.6 -4.6474603e+02  1    69.9
 20 -9.7 0.675 0.675 -15.8 -17.2  -8.9 -4.6474674e+02  1   149.7Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.120252e-17. 

 21-10.0 1.000 1.000 -15.9 -16.6  -9.6 -4.6474719e+02  1     4.6
   Converged

max |x| =      1.002    max |y| =      0.025    max |z| =      0.171   scaled
max |x| =    500.000    max |y| =      1.458    max |z| =     10.000 unscaled
PDitns =         21     LUitns =          0    cputime =        0.3

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1        15
[    0.1,       1)         0        13
[   0.01,     0.1)         0         1
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)         0         0
[  1e-05,  0.0001)         2         9
[  1e-06,   1e-05)        24        13
[      0,   1e-06)         1         0Elapsed time is 0.087045 seconds.
ROWS Section
COLUMNS section

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  7.0252103e+03  1    87.6      235 x2
  2  1.8 0.106 0.106   1.2  -0.1   1.5 -7.7077207e+02  1   240.8
  3  1.7 0.190 0.190   1.1  -0.1   1.4  5.7809341e+03  1    37.3
  4  1.6 0.477 0.477   0.8  -0.4   1.6 -4.2944510e+02  1    79.5
  5  1.3 0.752 0.752   0.2  -1.0   1.5  1.6677330e+03  1    63.4
  6  0.7 0.901 0.901  -0.8  -2.0   0.9 -5.1220871e+01  1    46.1
  7 -0.3 0.942 0.942  -2.0  -3.3   0.4 -3.6627137e+01  1    58.4
  8 -0.7 1.000 1.000 -14.1 -13.5  -0.4 -2.3818052e+01  1     3.9
  9 -1.7 1.000 1.000 -14.7 -14.2  -1.5 -1.9727586e+01  1     3.2
 10 -2.9 1.000 1.000 -14.7 -15.2  -2.4 -3.8321871e+01  1     5.5
 11 -3.6 0.813 0.813 -14.8 -15.9  -3.0 -1.2350272e+02  1   110.3
 12 -4.1 0.479 0.479 -15.2 -16.3  -3.2 -2.2313404e+02  1   181.6
 13 -4.3 0.612 0.612 -15.1 -16.7  -3.6 -3.4480091e+02  1   198.1
 14 -4.7 0.906 0.906 -15.8 -16.6  -4.2 -4.3605798e+02  1    38.1
 15 -5.4 0.803 0.803 -15.5 -17.1  -4.7 -4.5629045e+02  1    76.3
 16 -5.8 0.943 0.943 -15.1 -16.6  -5.3 -4.6297942e+02  1    28.2
 17 -6.5 1.000 1.000 -15.3 -16.6  -6.4 -4.6445901e+02  1     1.3
 18 -8.3 0.994 0.994 -15.5 -16.3  -8.0 -4.6474113e+02  1     3.4
 19 -9.3 0.868 0.868 -15.8 -16.9  -8.6 -4.6474603e+02  1    69.9
 20 -9.7 0.675 0.675 -16.0 -16.6  -8.9 -4.6474674e+02  1   149.7Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.900058e-16. 

 21-10.0 1.000 1.000 -16.0 -16.7  -9.6 -4.6474720e+02  1     4.6
   Converged

max |x| =      1.002    max |y| =      0.025    max |z| =      0.171   scaled
max |x| =    500.000    max |y| =      1.457    max |z| =     10.000 unscaled
PDitns =         21     LUitns =          0    cputime =        0.2

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1        15
[    0.1,       1)         0        13
[   0.01,     0.1)         0         1
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)         0         0
[  1e-05,  0.0001)         2         9
[  1e-06,   1e-05)        24        13
[      0,   1e-06)         1         0Elapsed time is 0.194864 seconds.

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  7.0252103e+03  1    87.6      337 x2
  2  1.8 0.106 0.106   1.2  -0.1   1.5 -7.7077207e+02  1   240.8
  3  1.7 0.190 0.190   1.1  -0.1   1.4  5.7809341e+03  1    37.3
  4  1.6 0.477 0.477   0.8  -0.4   1.6 -4.2944510e+02  1    79.5
  5  1.3 0.752 0.752   0.2  -1.0   1.5  1.6677330e+03  1    63.4
  6  0.7 0.901 0.901  -0.8  -2.0   0.9 -5.1220871e+01  1    46.1
  7 -0.3 0.942 0.942  -2.0  -3.3   0.4 -3.6627137e+01  1    58.4
  8 -0.7 1.000 1.000 -13.4 -13.6  -0.4 -2.3818052e+01  1     3.9
  9 -1.7 1.000 1.000 -15.0 -14.3  -1.5 -1.9727586e+01  1     3.2
 10 -2.9 1.000 1.000 -15.3 -15.4  -2.4 -3.8321871e+01  1     5.5
 11 -3.6 0.813 0.813 -14.9 -16.2  -3.0 -1.2350272e+02  1   110.3
 12 -4.1 0.479 0.479 -15.7 -16.4  -3.2 -2.2313404e+02  1   181.6
 13 -4.3 0.612 0.612 -15.7 -16.9  -3.6 -3.4480091e+02  1   198.1
 14 -4.7 0.906 0.906 -14.9 -16.9  -4.2 -4.3605798e+02  1    38.1
 15 -5.4 0.803 0.803 -15.6 -16.3  -4.7 -4.5629045e+02  1    76.3
 16 -5.8 0.943 0.943 -15.6 -16.6  -5.3 -4.6297942e+02  1    28.2
 17 -6.5 1.000 1.000 -15.2 -16.9  -6.4 -4.6445901e+02  1     1.3
 18 -8.3 0.994 0.994 -15.4 -16.3  -8.0 -4.6474113e+02  1     3.4
 19 -9.3 0.868 0.868 -15.8 -16.6  -8.6 -4.6474603e+02  1    69.9
 20 -9.7 0.675 0.675 -16.0 -16.9  -8.9 -4.6474674e+02  1   149.7Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.120799e-17. 

 21-10.0 1.000 1.000 -16.0 -16.9  -9.6 -4.6474720e+02  1     4.6
   Converged

max |x| =      1.002    max |y| =      0.025    max |z| =      0.171   scaled
max |x| =    500.000    max |y| =      1.457    max |z| =     10.000 unscaled
PDitns =         21     LUitns =          0    cputime =        0.2

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1        15
[    0.1,       1)         0        13
[   0.01,     0.1)         0         1
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)         0         0
[  1e-05,  0.0001)         2         9
[  1e-06,   1e-05)        24        13
[      0,   1e-06)         1         0Elapsed time is 0.089072 seconds.
ROWS Section
COLUMNS section

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  7.0357180e+03  1    87.6      235 x2
  2  1.8 0.106 0.106   1.2  -0.1   1.5 -4.3461471e+02  1   240.9
  3  1.7 0.190 0.190   1.1  -0.1   1.4  7.6888563e+03  1    37.3
  4  1.6 0.478 0.478   0.8  -0.4   1.6  1.0487268e+04  1    79.5
  5  1.3 0.753 0.753   0.2  -1.0   1.5  3.4782817e+04  1    63.4
  6  0.7 0.919 0.919  -0.9  -2.1   0.9  4.9696728e+04  1    45.4
  7 -0.3 0.962 0.962  -2.3  -3.6   0.4  1.0578984e+04  1    59.5
  8 -0.7 1.000 1.000 -13.7 -13.5  -0.4  3.7957770e+02  1     4.8
  9 -1.6 1.000 1.000 -14.9 -14.3  -1.4 -2.5518247e+01  1     3.5
 10 -2.7 1.000 1.000 -14.7 -15.2  -2.4 -4.2195864e+01  1     3.7
 11 -3.7 0.827 0.827 -15.2 -15.9  -2.9 -1.0829681e+02  1    62.2
 12 -4.0 0.511 0.511 -15.4 -16.2  -3.2 -1.9898916e+02  1   113.5
 13 -4.2 0.508 0.508 -15.4 -16.4  -3.4 -3.0846541e+02  1   228.5
 14 -4.5 0.946 0.946 -15.0 -16.3  -4.1 -4.3355106e+02  1    26.5
 15 -5.3 0.606 0.606 -15.3 -16.9  -4.5 -4.4928674e+02  1   177.4
 16 -5.5 0.939 0.939 -15.8 -16.5  -5.0 -4.6164871e+02  1    27.1
 17 -6.1 1.000 1.000 -15.3 -16.8  -6.1 -4.6410386e+02  1     1.3
 18 -7.9 1.000 1.000 -15.8 -16.6  -7.7 -4.6473706e+02  1     2.6
 19 -9.2 0.868 0.868 -15.7 -16.9  -8.4 -4.6474598e+02  1    44.3
 20 -9.4 0.784 0.784 -15.9 -17.2  -8.8 -4.6474691e+02  1    73.1Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.765154e-16. 

 21 -9.9 0.731 0.731 -15.9 -16.6  -9.2 -4.6474725e+02  1   204.5
   Converged

max |x| =      1.002    max |y| =      0.016    max |z| =      0.171   scaled
max |x| =    500.000    max |y| =      0.943    max |z| =     10.000 unscaled
PDitns =         21     LUitns =          0    cputime =        0.3

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        13         0
[      1,      10)         0         9
[    0.1,       1)         0        20
[   0.01,     0.1)         0         0
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)         0         0
[  1e-05,  0.0001)        16         9
[  1e-06,   1e-05)         9        13
[      0,   1e-06)         2         0Elapsed time is 0.158999 seconds.

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  7.0357180e+03  1    87.6      337 x2
  2  1.8 0.106 0.106   1.2  -0.1   1.5 -4.3461471e+02  1   240.9
  3  1.7 0.190 0.190   1.1  -0.1   1.4  7.6888563e+03  1    37.3
  4  1.6 0.478 0.478   0.8  -0.4   1.6  1.0487268e+04  1    79.5
  5  1.3 0.753 0.753   0.2  -1.0   1.5  3.4782817e+04  1    63.4
  6  0.7 0.919 0.919  -0.9  -2.1   0.9  4.9696728e+04  1    45.4
  7 -0.3 0.962 0.962  -2.3  -3.6   0.4  1.0578984e+04  1    59.5
  8 -0.7 1.000 1.000 -13.7 -13.6  -0.4  3.7957770e+02  1     4.8
  9 -1.6 1.000 1.000 -14.8 -14.1  -1.4 -2.5518247e+01  1     3.5
 10 -2.7 1.000 1.000 -15.0 -15.2  -2.4 -4.2195864e+01  1     3.7
 11 -3.7 0.827 0.827 -14.7 -15.9  -2.9 -1.0829681e+02  1    62.2
 12 -4.0 0.511 0.511 -15.0 -16.2  -3.2 -1.9898916e+02  1   113.5
 13 -4.2 0.508 0.508 -15.1 -16.5  -3.4 -3.0846541e+02  1   228.5
 14 -4.5 0.946 0.946 -15.7 -16.6  -4.1 -4.3355106e+02  1    26.5
 15 -5.3 0.606 0.606 -15.3 -16.8  -4.5 -4.4928674e+02  1   177.4
 16 -5.5 0.939 0.939 -15.3 -16.3  -5.0 -4.6164871e+02  1    27.1
 17 -6.1 1.000 1.000 -15.6 -16.6  -6.1 -4.6410386e+02  1     1.3
 18 -7.9 1.000 1.000 -15.2 -16.6  -7.7 -4.6473706e+02  1     2.6
 19 -9.2 0.868 0.868 -15.7 -16.6  -8.4 -4.6474598e+02  1    44.3
 20 -9.4 0.784 0.784 -15.9 -16.9  -8.8 -4.6474691e+02  1    73.1Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.198613e-16. 

 21 -9.9 0.731 0.731 -15.9 -17.4  -9.2 -4.6474725e+02  1   204.5
   Converged

max |x| =      1.002    max |y| =      0.016    max |z| =      0.171   scaled
max |x| =    500.000    max |y| =      0.943    max |z| =     10.000 unscaled
PDitns =         21     LUitns =          0    cputime =        0.2

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        13         0
[      1,      10)         0         9
[    0.1,       1)         0        20
[   0.01,     0.1)         0         0
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)         0         0
[  1e-05,  0.0001)        16         9
[  1e-06,   1e-05)         9        13
[      0,   1e-06)         2         0Elapsed time is 0.058692 seconds.
ROWS Section
COLUMNS section

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  8.0773340e+03  1    87.6      235 x2
  2  1.8 0.107 0.107   1.2  -0.1   1.5  3.2909002e+04  1   242.6
  3  1.7 0.194 0.194   1.1  -0.1   1.4  1.9577211e+05  1    37.7
  4  1.6 0.499 0.499   0.8  -0.5   1.7  1.0478582e+06  1    82.9
  5  1.3 0.825 0.825   0.1  -1.2   1.5  2.5805273e+06  1    62.8
  6  0.6 1.000 1.000 -15.4 -12.9   0.8  1.4221463e+06  1     3.4
  7 -0.5 0.891 0.891 -15.7 -13.4   0.3  3.3613035e+05  1    27.5
  8 -0.8 1.000 1.000 -14.9 -13.8  -0.3  5.5771008e+04  1     6.8
  9 -1.4 1.000 1.000 -15.4 -14.0  -0.8  5.9306043e+03  1     7.4
 10 -1.9 1.000 1.000 -14.4 -14.8  -1.4  4.8500024e+02  1     3.5
 11 -2.6 1.000 1.000 -14.7 -15.4  -2.2  4.2865042e+01  1     3.5
 12 -3.4 0.921 0.921 -15.4 -16.0  -2.7 -6.1180527e+01  1    80.5
 13 -3.8 0.514 0.514 -15.9 -16.3  -3.0 -1.4675416e+02  1   135.7
 14 -4.1 0.456 0.456 -15.5 -16.6  -3.2 -2.5040057e+02  1   244.4
 15 -4.3 0.893 0.893 -15.5 -16.6  -3.9 -4.0700234e+02  1    44.6
 16 -5.1 0.657 0.657 -15.3 -16.8  -4.2 -4.3830225e+02  1    75.6
 17 -5.3 0.889 0.889 -15.5 -16.9  -4.8 -4.5804654e+02  1    49.8
 18 -6.0 1.000 1.000 -15.6 -16.9  -5.7 -4.6403538e+02  1    14.9
 19 -7.0 0.908 0.908 -15.5 -16.6  -6.5 -4.6466190e+02  1    32.5
 20 -7.7 0.857 0.857 -15.8 -17.2  -7.0 -4.6473632e+02  1   179.6
 21 -8.1 1.000 1.000 -15.8 -16.6  -7.5 -4.6475544e+02  1     5.8
 22 -8.6 0.803 0.803 -15.8 -16.6  -7.9 -4.6476185e+02  1    29.9
 23 -9.0 1.000 1.000 -15.8 -16.6  -8.4 -4.6476426e+02  1    21.0
 24 -9.6 1.000 1.000 -15.8 -17.5  -9.0 -4.6476508e+02  1     8.8
 25-10.0 1.000 1.000 -16.0 -16.6  -9.5 -4.6476529e+02  1     4.3
   Converged

max |x| =      1.002    max |y| =      0.016    max |z| =      0.171   scaled
max |x| =    500.009    max |y| =      0.943    max |z| =     10.000 unscaled
PDitns =         25     LUitns =          0    cputime =        0.2

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1         1
[    0.1,       1)         0        15
[   0.01,     0.1)         0        13
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)        12         0
[  1e-05,  0.0001)        10         9
[  1e-06,   1e-05)         4        13
[      0,   1e-06)         1         0Elapsed time is 0.171205 seconds.

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.026 0.026   1.3  -0.0   0.5  8.0773340e+03  1    87.6      337 x2
  2  1.8 0.107 0.107   1.2  -0.1   1.5  3.2909002e+04  1   242.6
  3  1.7 0.194 0.194   1.1  -0.1   1.4  1.9577211e+05  1    37.7
  4  1.6 0.499 0.499   0.8  -0.5   1.7  1.0478582e+06  1    82.9
  5  1.3 0.825 0.825   0.1  -1.2   1.5  2.5805273e+06  1    62.8
  6  0.6 1.000 1.000 -15.8 -13.2   0.8  1.4221463e+06  1     3.4
  7 -0.5 0.891 0.891 -15.1 -13.5   0.3  3.3613035e+05  1    27.5
  8 -0.8 1.000 1.000 -15.0 -13.8  -0.3  5.5771008e+04  1     6.8
  9 -1.4 1.000 1.000 -14.5 -14.3  -0.8  5.9306043e+03  1     7.4
 10 -1.9 1.000 1.000 -14.1 -15.0  -1.4  4.8500024e+02  1     3.5
 11 -2.6 1.000 1.000 -15.0 -15.1  -2.2  4.2865042e+01  1     3.5
 12 -3.4 0.921 0.921 -14.8 -16.4  -2.7 -6.1180527e+01  1    80.5
 13 -3.8 0.514 0.514 -15.1 -16.7  -3.0 -1.4675416e+02  1   135.7
 14 -4.1 0.456 0.456 -15.2 -16.9  -3.2 -2.5040057e+02  1   244.4
 15 -4.3 0.893 0.893 -15.5 -16.9  -3.9 -4.0700234e+02  1    44.6
 16 -5.1 0.657 0.657 -15.4 -17.0  -4.2 -4.3830225e+02  1    75.6
 17 -5.3 0.889 0.889 -15.6 -16.6  -4.8 -4.5804654e+02  1    49.8
 18 -6.0 1.000 1.000 -15.3 -16.6  -5.7 -4.6403538e+02  1    14.9
 19 -7.0 0.908 0.908 -15.5 -16.6  -6.5 -4.6466190e+02  1    32.5
 20 -7.7 0.857 0.857 -15.2 -17.2  -7.0 -4.6473632e+02  1   179.6
 21 -8.1 1.000 1.000 -15.8 -16.6  -7.5 -4.6475544e+02  1     5.8
 22 -8.6 0.803 0.803 -15.8 -16.3  -7.9 -4.6476185e+02  1    29.9
 23 -9.0 1.000 1.000 -15.8 -16.6  -8.4 -4.6476426e+02  1    21.0Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.907623e-16. 

 24 -9.6 1.000 1.000 -15.8 -17.5  -9.0 -4.6476508e+02  1     8.8Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.325293e-17. 

 25-10.0 1.000 1.000 -16.0 -17.5  -9.5 -4.6476529e+02  1     4.3
   Converged

max |x| =      1.002    max |y| =      0.016    max |z| =      0.171   scaled
max |x| =    500.009    max |y| =      0.943    max |z| =     10.000 unscaled
PDitns =         25     LUitns =          0    cputime =        0.3

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1         1
[    0.1,       1)         0        15
[   0.01,     0.1)         0        13
[  0.001,    0.01)         0         0
[ 0.0001,   0.001)        12         0
[  1e-05,  0.0001)        10         9
[  1e-06,   1e-05)         4        13
[      0,   1e-06)         1         0Elapsed time is 0.051019 seconds.
ROWS Section
COLUMNS section

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.032 0.032   1.3  -0.0   0.6  1.3253844e+05  1    95.6      235 x2
  2  1.8 0.169 0.169   1.2  -0.1   1.7  4.0408212e+06  1   304.3
  3  1.7 0.666 0.666   0.7  -0.6   1.9  2.1117758e+07  1    86.3
  4  1.2 1.000 1.000 -14.5 -12.7   1.4  1.2607812e+07  1     2.0
  5 -0.0 1.000 1.000 -14.3 -13.8   0.8  3.2450991e+06  1     1.9
  6 -0.2 1.000 1.000 -14.8 -14.4   0.3  9.0629193e+05  1     1.7
  7 -0.8 1.000 1.000 -14.8 -14.6  -0.2  2.2667958e+05  1     2.5
  8 -1.4 1.000 1.000 -15.1 -14.8  -0.8  5.2774696e+04  1     3.8
  9 -1.9 1.000 1.000 -14.9 -15.2  -1.3  1.1410199e+04  1     7.0
 10 -2.5 0.932 0.932 -15.3 -15.6  -1.8  2.5219925e+03  1   145.0
 11 -2.9 1.000 1.000 -15.5 -15.8  -2.4  3.5158858e+02  1     5.2
 12 -3.5 0.984 0.984 -14.8 -16.5  -2.9 -4.7738071e+01  1    59.0
 13 -4.1 0.487 0.487 -14.8 -16.6  -3.2 -1.4482765e+02  1   121.7
 14 -4.2 0.465 0.465 -15.0 -16.6  -3.4 -2.7286718e+02  1   227.8
 15 -4.4 0.909 0.909 -15.2 -16.7  -3.9 -4.2872732e+02  1    70.1
 16 -5.0 0.722 0.722 -15.5 -17.0  -4.2 -4.5031703e+02  1    61.4
 17 -5.3 0.892 0.892 -15.6 -17.2  -4.9 -4.6158607e+02  1    48.0
 18 -6.0 0.644 0.644 -15.4 -17.2  -5.2 -4.6451342e+02  1   163.0
 19 -6.2 1.000 1.000 -15.3 -16.6  -5.7 -4.6591257e+02  1     4.3
 20 -6.8 0.779 0.779 -15.7 -16.6  -6.1 -4.6632228e+02  1    33.8
 21 -7.2 1.000 1.000 -15.6 -17.4  -6.6 -4.6648384e+02  1     3.9
 22 -7.8 1.000 1.000 -15.8 -16.6  -7.2 -4.6653684e+02  1     7.7
 23 -8.3 1.000 1.000 -15.9 -16.6  -7.7 -4.6655149e+02  1     5.0
 24 -8.8 1.000 1.000 -16.0 -16.6  -8.2 -4.6655598e+02  1     8.1
 25 -9.4 0.961 0.961 -16.0 -16.6  -8.8 -4.6655729e+02  1   155.6Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.198547e-16. 

 26 -9.9 1.000 1.000 -16.0 -16.3  -9.3 -4.6655773e+02  1     4.5
   Converged

max |x| =      1.004    max |y| =      0.016    max |z| =      0.171   scaled
max |x| =    500.874    max |y| =      0.943    max |z| =     10.000 unscaled
PDitns =         26     LUitns =          0    cputime =        0.4

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1         1
[    0.1,       1)         0         7
[   0.01,     0.1)         0         9
[  0.001,    0.01)        13        12
[ 0.0001,   0.001)         8         0
[  1e-05,  0.0001)         2         9
[  1e-06,   1e-05)         3        13
[      0,   1e-06)         1         0Elapsed time is 0.184113 seconds.

   --------------------------------------------------------
   pdco.m                            Version of 23 Nov 2013
   Primal-dual barrier method to minimize a convex function
   subject to linear constraints Ax + r = b,  bl &lt;= x &lt;= bu
                                                           
   Michael Saunders       SOL and ICME, Stanford University
   Contributors:     Byunggyoo Kim (SOL), Chris Maes (ICME)
                     Santiago Akle (ICME), Matt Zahr (ICME)
   --------------------------------------------------------

A is a sparse matrix

m =       27     n =       51      nnz(A) =       102
max |b | =       44     max |x0| =       xsize = 
max |y0| =        0     max |z0| =       zsize = 

x0min =        1     featol =       d1max = 
z0min =        1     opttol =       d2max = 
mu0 =      bigcenter =     1000

Method   = LU


Bounds:
  [0, inf]  [-inf, 0]  Finite bl  Finite bu  Two bnds   Fixed    Free
       32        13         32         19         0       0       0
  [0, bu]  [bl,  0]  excluding fixed variables
       32        13

Itn   mu stepx stepz  Pinf  Dinf  Cinf   Objective    nf  center       LU
  0                    1.3   0.0   0.0  4.0918595e+03        1.0
  1  1.8 0.032 0.032   1.3  -0.0   0.6  1.3253844e+05  1    95.6      337 x2
  2  1.8 0.169 0.169   1.2  -0.1   1.7  4.0408212e+06  1   304.3
  3  1.7 0.666 0.666   0.7  -0.6   1.9  2.1117758e+07  1    86.3
  4  1.2 1.000 1.000 -14.7 -13.0   1.4  1.2607812e+07  1     2.0
  5 -0.0 1.000 1.000 -14.8 -14.0   0.8  3.2450991e+06  1     1.9
  6 -0.2 1.000 1.000 -14.8 -14.1   0.3  9.0629193e+05  1     1.7
  7 -0.8 1.000 1.000 -15.0 -14.4  -0.2  2.2667958e+05  1     2.5
  8 -1.4 1.000 1.000 -14.9 -14.8  -0.8  5.2774696e+04  1     3.8
  9 -1.9 1.000 1.000 -15.2 -15.1  -1.3  1.1410199e+04  1     7.0
 10 -2.5 0.932 0.932 -14.9 -15.6  -1.8  2.5219925e+03  1   145.0
 11 -2.9 1.000 1.000 -15.5 -16.1  -2.4  3.5158858e+02  1     5.2
 12 -3.5 0.984 0.984 -14.5 -16.2  -2.9 -4.7738071e+01  1    59.0
 13 -4.1 0.487 0.487 -14.7 -16.5  -3.2 -1.4482765e+02  1   121.7
 14 -4.2 0.465 0.465 -15.0 -16.9  -3.4 -2.7286718e+02  1   227.8
 15 -4.4 0.909 0.909 -15.1 -17.1  -3.9 -4.2872732e+02  1    70.1
 16 -5.0 0.722 0.722 -15.5 -17.1  -4.2 -4.5031703e+02  1    61.4
 17 -5.3 0.892 0.892 -15.9 -16.6  -4.9 -4.6158607e+02  1    48.0
 18 -6.0 0.644 0.644 -15.5 -17.2  -5.2 -4.6451342e+02  1   163.0
 19 -6.2 1.000 1.000 -15.8 -17.2  -5.7 -4.6591257e+02  1     4.3
 20 -6.8 0.779 0.779 -15.5 -17.5  -6.1 -4.6632228e+02  1    33.8
 21 -7.2 1.000 1.000 -15.5 -17.5  -6.6 -4.6648384e+02  1     3.9
 22 -7.8 1.000 1.000 -15.8 -16.6  -7.2 -4.6653684e+02  1     7.7
 23 -8.3 1.000 1.000 -16.0 -16.6  -7.7 -4.6655149e+02  1     5.0
 24 -8.8 1.000 1.000 -16.0 -17.5  -8.2 -4.6655598e+02  1     8.1
 25 -9.4 0.961 0.961 -16.0 -17.7  -8.8 -4.6655729e+02  1   155.6Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.348791e-17. 

 26 -9.9 1.000 1.000 -16.0 -16.6  -9.3 -4.6655773e+02  1     4.5
   Converged

max |x| =      1.004    max |y| =      0.016    max |z| =      0.171   scaled
max |x| =    500.874    max |y| =      0.943    max |z| =     10.000 unscaled
PDitns =         26     LUitns =          0    cputime =        0.3

Distribution of vector     x         z
[    100,   1e+03)        11         0
[     10,     100)        12         0
[      1,      10)         1         1
[    0.1,       1)         0         7
[   0.01,     0.1)         0         9
[  0.001,    0.01)        13        12
[ 0.0001,   0.001)         8         0
[  1e-05,  0.0001)         2         9
[  1e-06,   1e-05)         3        13
[      0,   1e-06)         1         0Elapsed time is 0.063672 seconds.
</pre><img vspace="5" hspace="5" src="modify_d1_d2_K35_01.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_02.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_03.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_04.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_05.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_06.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_07.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_08.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_09.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_10.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_11.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_12.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_13.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_14.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_15.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_16.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_17.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_18.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_19.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_20.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_21.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_22.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_23.png" alt=""> <img vspace="5" hspace="5" src="modify_d1_d2_K35_24.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Clean
clear all
close all
clc
%% Setup 1
pdcoo_home = pwd;

addpath(pdcoo_home);
addpath(fullfile(pdcoo_home, 'Formulations'));
addpath(fullfile(pdcoo_home, 'Solvers'));
addpath(fullfile(pdcoo_home, 'readmps'));
addpath(fullfile(pdcoo_home, 'Tools'));
addpath(fullfile(pdcoo_home, 'Problems\MPS'));
addpath(fullfile(pdcoo_home, 'Validation-eigenvalue'));
p = genpath(fullfile(pdcoo_home, 'addons'));
addpath(p);
p = genpath(fullfile(pdcoo_home, 'Results'));
addpath(p);
if exist('Variants', 'dir') ~= 7
    mkdir('Variants');
end
addpath(fullfile(pdcoo_home, 'Variants'));
addpath(fullfile(pdcoo_home, 'Test'));
%% Setup 2
import model.lpmodel;
import model.slackmodel;

options_pdco.file_id = 1;

formulation1 = 'K25';
solver = 'LU';
classname1 = build_variant(pdcoo_home, formulation1, solver);

formulation2 = 'K35';
solver = 'LU';
classname2 = build_variant(pdcoo_home, formulation2, solver);

formulation3 = 'K2';
solver = 'LU';
classname3 = build_variant(pdcoo_home, formulation3, solver);

path_qp = '';
list_problem = {'D:\git_repository\Stage-K2.5\Problems\qp_prob\qafiro.qps'}



n_problem = length(list_problem);

options_pdco.d1 = 1.0e-2;
options_pdco.d2 = 1.0e-2;
options_pdco.OptTol = 1.0e-9;
options_solv.atol1 = 1.0e-4;
options_solv.atol2 = 1.0e-10;
options_solv.itnlim = 10;
options_pdco.Print = 1;

fprintf(options_pdco.file_id, ...
    '\n    Name    Objectif   Presid   Dresid   Cresid   PDitns   Inner     Time      D2 * r\n\n');

result = zeros(9,3,n_problem);
%% Check eigenvalues and compare method
n_problem = min(n_problem, 20000);
check_eigenvalue = 1;
check_eigenvalueK35 = 1;
show_one_graphic = 0; % = 1  need check_eigenvalue = 1
show_all_graphic = 0; % = 1  need check_eigenvalue = 1
check_cond = 1;
compare_formulations = 0;
check_residu = 0;
check_all_residu = 0; % = 1  need check_residu = 1
%% Loop
clc

d1 = 10^-4;
d2 = [0 10^-16 10^-4 10^-2 10^-1 1];
options_pdco.d1 = d1;
for j = 1:length(d2)
    options_pdco.d2 = d2(j);
    
    mps_name = list_problem{1};
    
    % Read .mps file
    mps_stru = readmps(mps_name);
    lp = mpstolp(mps_stru);
    slack = slackmodel(lp);
    Anorm = normest(slack.gcon(slack.x0), 1.0e-3);
    
    options_pdco.x0 = slack.x0;
    options_pdco.x0(slack.jLow) = slack.bL(slack.jLow) + 1;
    options_pdco.x0(slack.jUpp) = slack.bU(slack.jUpp) - 1;
    options_pdco.x0(slack.jTwo) = (slack.bL(slack.jTwo) + slack.bU(slack.jTwo)) / 2;
    options_pdco.xsize = max(norm(options_pdco.x0, inf), 1);
    options_pdco.zsize = max(norm(slack.gobj(slack.x0), inf) + sqrt(slack.n) * Anorm, 1);
    options_pdco.z0 = options_pdco.zsize * ones(slack.n, 1);
    options_pdco.y0 = zeros(slack.m, 1);
    options_pdco.mu0 = options_pdco.zsize;
    options_pdco.Maxiter = min(max(30, slack.n), 100);
    options_pdco.check_eigenvalue = check_eigenvalue;
    options_pdco.check_eigenvalueK35 = check_eigenvalueK35;
    options_pdco.check_residu = check_residu;
    options_pdco.check_cond = check_cond;
    options_form = struct();
    
    Problem1 = eval([classname1, '(slack, options_pdco,options_form,options_solv)']);
    Problem1.solve;
    Problem2 = eval([classname2, '(slack, options_pdco,options_form,options_solv)']);
    Problem2.solve;
    
    show_eigenvalue(Problem1.eigenvalue, Problem1.limit, d1, d2(j))
    show_eigenvalueK35(Problem2.eigenvalue, d1, d2(j))
    
   
    
end

fclose('all');
##### SOURCE END #####
--></body></html>